% =====================
% |     POC LAB 1     |
% |       SEM 7       |
% | Dawid Tobor gr. 4 |
% =====================

close all
clear variables
clc

disp ('Script is working. Please wait...');

% Salt & pepper noise is used
[org_img, noised_img, noised_bw_img] = gen_noise('../images/color/05_512x512', 'imp', 0.02, false, '', true, '');
bw_img = rgb2gray(org_img);

[org_img2, noised_img2, noised_bw_img2] = gen_noise('../images/color/14_512x512', 'imp', 0.1, false, '', true, '');
bw_img2 = rgb2gray(org_img2);

filt_img3 = filt_med(noised_bw_img, 3, false);
filt_img5 = filt_med(noised_bw_img, 5, false);
filt_img_lum1 = filt_lum(noised_bw_img, 3, 1, false);
filt_img_lum3 = filt_lum(noised_bw_img, 3, 3, false);

filt_img3_2 = filt_med(noised_bw_img2, 3, false);
filt_img5_2 = filt_med(noised_bw_img2, 5, false);
filt_img_lum1_2 = filt_lum(noised_bw_img2, 3, 1, false);
filt_img_lum3_2 = filt_lum(noised_bw_img2, 3, 3, false);

PSNR1_1 = psnr(filt_img3(2:end-1,2:end-1,:), bw_img(2:end-1,2:end-1,:));
PSNR1_2 = psnr(filt_img5(3:end-1,2:end-1,:), bw_img(3:end-1,2:end-1,:));
PSNR1_3 = psnr(filt_img_lum1(2:end-1,2:end-1,:), bw_img(2:end-1,2:end-1,:));
PSNR1_4 = psnr(filt_img_lum3(2:end-1,2:end-1,:), bw_img(2:end-1,2:end-1,:));

PSNR2_1 = psnr(filt_img3_2(2:end-1,2:end-1,:), bw_img2(2:end-1,2:end-1,:));
PSNR2_2 = psnr(filt_img5_2(3:end-1,3:end-1,:), bw_img2(3:end-1,3:end-1,:));
PSNR2_3 = psnr(filt_img_lum1_2(2:end-1,2:end-1,:), bw_img2(2:end-1,2:end-1,:));
PSNR2_4 = psnr(filt_img_lum3_2(2:end-1,2:end-1,:), bw_img2(2:end-1,2:end-1,:));

figure;
subplot(2,4,1);  imshow(bw_img); title('Original image');
subplot(2,4,2);  imshow(noised_bw_img); title('Noised image (2%)');
subplot(2,4,3);  imshow(filt_img3); title(['HSV 1, PSNR = ', num2str(PSNRHSV1)]);title('Filtered image - median (3x3)');
subplot(2,4,4);  imshow(filt_img5); title('Filtered image - median (5x5)');
subplot(2,4,7);  imshow(filt_img_lum1); title('Filtered image - LUM k=1');
subplot(2,4,8);  imshow(filt_img_lum3); title('Original image - LUM k=3');

figure;
subplot(2,4,1);  imshow(bw_img2); title('Original image');
subplot(2,4,2);  imshow(noised_bw_img2); title('Noised image (10%)');
subplot(2,4,3);  imshow(filt_img3_2); title('Filtered image - median (3x3)');
subplot(2,4,4);  imshow(filt_img5_2); title('Filtered image - median (5x5)');
subplot(2,4,7);  imshow(filt_img_lum1_2); title('Filtered image - LUM k=1');
subplot(2,4,8);  imshow(filt_img_lum3_2); title('Original image - LUM k=3');


%figure;
%imshow(filt_img_lum);

%filt_imgvmf = filt_vmf(noised_img, 3);
%figure;
%imshow(filt_imgvmf);

clc
disp ('Finished :)');

%PSNR
%PSNR = psnr(Obraz(2:end-1,2:end-1,:), ObrazOryginalny(2:end-1,2:end-1,:));


% Przyklad wyswietlania PSNRow na subplocie
%{

figure;
w=subplot(2,3,1);  imshow(ImageOrigin); title('Original image');
w=subplot(2,3,2);  imshow(QuantHSV1); title(['HSV 1, PSNR = ', num2str(PSNRHSV1)]);
w=subplot(2,3,3);  imshow(QuantHSV2); title(['HSV 2, PSNR = ', num2str(PSNRHSV2)]);
w=subplot(2,3,4);  imshow(ImageOrigin2); title('Original image');
w=subplot(2,3,5);  imshow(QuantHSV1_2); title(['HSV 1, PSNR = ', num2str(PSNRHSV1_2)]);
w=subplot(2,3,6);  imshow(QuantHSV2_2); title(['HSV 2, PSNR = ', num2str(PSNRHSV2_2)]);

%}